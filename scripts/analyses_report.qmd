---
title: "DFM - End of Phase Surveys"
format: html
# format:
#   docx:
#     toc: true
#     number-sections: true
date: "`r format(Sys.time(), '%B %d %Y')`"
echo: false
warning: false
---

```{r libraries}
pacman::p_load(here,
               tidyverse, 
               gtsummary, 
               bstfun, 
               flextable,
               rstatix,
               openxlsx,
               Hmisc,
               magrittr,
               DT)

options(dplyr.summarise.inform = FALSE) 
```

```{r load_data}
#source(str_c(here(), "/scripts/prepare_dataset.R"))
load(here("data", "eop_data.Rdata"))
```

# Academic year 2020-2021
# 3rd years, (Class Of 2022)

# Dataset
```{r display_data}
eop3_grades %>%
  select(ResearchID, EvalCC3_1, CRSE_GRADE_OFF, CRSE_LD, LIC) %>%
  datatable(.)
```

# Data Summary
```{r display_summary}

eop3_grades %>%
  select(EvalCC3_1, CRSE_GRADE_OFF, CRSE_LD, LIC) %>%
  summary(.) %>%
  knitr::kable(.)
```


```{r participant_demographics}

```

# Research Question 1: 

What is the relationship between clerkship evaluations and grades from the family medicine and primary care clerkship?
```{r}
eop3_grades %>%
  filter(EvalCC3_1 != 9) %>%
  cor_test(
    EvalCC3_1, 
    CRSE_GRADE_OFF, 
    method = "kendall"
    ) %>%
  knitr::kable(.)
test_stat <- 
  eop3_grades %>%
  filter(EvalCC3_1 != 9) %>%
  cor_test(
    EvalCC3_1, 
    CRSE_GRADE_OFF, 
    method = "kendall"
    ) %>%
  pull(cor) 
```

There was a significant positive relationship between a student's clerkship evaluation and their grades from the family medicine and primary care clerkship, r<sub>$\tau$</sub> = `r test_stat[["tau"]]`, p (two-tailed) < 0.05.

# Research Question 2: 

What is the relationship between family medicine and primary care clerkship grades and professional identity in 3rd year medical students?
```{r}
eop3_grades %>%
  filter(EvalCC3_1 != 9) %>%
  cor_test(
    CRSE_GRADE_OFF, 
    ProfID, 
    method = "kendall"
    ) %>%
  knitr::kable(.)

test_stat <- 
  eop3_grades %>%
  filter(EvalCC3_1 != 9) %>%
  cor_test( 
    CRSE_GRADE_OFF,
    ProfID,
    method = "kendall"
    ) %>%
  pull(cor) 
```

Family medicine and primary care clerkship grades were not significantly related to a mean of professional identity scores, r<sub>$\tau$</sub> = `r test_stat[["tau"]]`, p (two-tailed) > 0.05.

Possible that the relationship between clerkship grades and professional identity is different between those in the LIC vs those who were not.
```{r}
eop3_grades %>%
  filter(EvalCC3_1 != 9) %>%
  group_by(LIC) %>%
  cor_test(
    CRSE_GRADE_OFF, 
    ProfID, 
    method = "kendall"
    ) %>%
  knitr::kable(.)

test_stat <- 
  eop3_grades %>%
  filter(EvalCC3_1 != 9) %>%
  group_by(LIC) %>%
  cor_test( 
    CRSE_GRADE_OFF,
    ProfID,
    method = "kendall"
    ) %>%
  pull(cor) 
```

Family medicine and primary care clerkship grades were not significantly related to a mean of professional identity scores in students not enrolled in an LIC clerkship, r<sub>$\tau$</sub> = `r test_stat[1][[1]]`, p (two-tailed) > 0.05. 

Similarly, among students who were enrolled in an LIC clerkship, family medicine and primary care clerkship grades were not significantly related to a mean of professional identity scores, r<sub>$\tau$</sub> = `r test_stat[1][[1]]`, p (two-tailed) > 0.05. 

No evidence for a relationship between grades from the family medicine and primary care clerkship and measures of professional identity. Furthermore, the same holds true when disaggretating data by whether or not a student was enrolled in an LIC clerkship.